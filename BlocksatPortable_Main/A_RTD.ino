#include "polyline.h"

long obtainPK(float coord_x, float coord_y)
{
      PointFS rtd[] = 
      {
      {  1,  0,  0, 0, 425357.395, 4593463.769, 200.0 },
      {  2,  0,  0, 0, 425371.485, 4593472.779, 216.7 },
      {  3,  0,  0, 0, 425384.145, 4593479.749, 231.2 },
      {  4,  1,  1, 0, 425396.535, 4593486.478, 245.3 },
      {  5,  1,101, 0, 425408.766, 4593493.608, 259.5 },
      {  6,  1,102, 0, 425420.476, 4593500.588, 273.1 },
      {  7,  1,102, 0, 425432.416, 4593507.318, 286.8 },
      {  8,  1,103, 0, 425439.256, 4593525.158, 305.9 },
      {  9,  1,103, 0, 425457.216, 4593522.768, 324.0 },
      { 10,  1,103, 0, 425468.706, 4593530.058, 337.6 },
      { 11,  1,103, 0, 425481.096, 4593537.898, 352.3 },
      { 12,  1,103, 0, 425493.726, 4593546.048, 367.3 },
      { 13,  1,103, 0, 425505.966, 4593554.208, 382.0 },
      { 14,  1,103, 0, 425518.516, 4593562.278, 396.9 },
      { 15,  1,103, 0, 425529.356, 4593569.968, 410.2 },
      { 16,  1,103, 0, 425542.416, 4593577.568, 425.3 },
      { 17,  1,103, 0, 425555.746, 4593584.057, 440.1 },
      { 18,  1,103, 0, 425568.777, 4593590.097, 454.5 },
      { 19,  1,103, 0, 425581.327, 4593594.517, 467.8 },
      { 20,  1,103, 0, 425594.687, 4593597.927, 481.6 },
      { 21,  1,103, 0, 425609.277, 4593601.097, 496.5 },
      { 22,  2,  2, 0, 425623.567, 4593602.517, 510.9 },
      { 23,  2,  2, 0, 425637.407, 4593603.487, 524.8 },
      { 24,  2,  2, 0, 425651.627, 4593603.817, 539.0 },
      { 25,  2,  2, 0, 425666.677, 4593602.397, 554.1 },
      { 26,  2,  2, 0, 425682.127, 4593601.917, 569.6 },
      { 27,  2,  2, 0, 425695.667, 4593602.096, 583.1 },
      { 28,  2,  2, 0, 425697.647, 4593593.086, 592.34 },
      { 29,  3,  3, 0, 425706.257, 4593608.056, 595.3 },
      { 30,  3,  3, 0, 425709.297, 4593619.226, 606.9 },
      { 31,  3,  3, 0, 425707.907, 4593633.116, 620.9 },
      { 32,  4,  4, 0, 425705.477, 4593652.076, 640.0 },
      { 33,  4,  4, 0, 425703.047, 4593671.896, 660.0 },
      { 34,  4,  4, 0, 425700.088, 4593693.927, 682.2 },
      { 35,  4,  4, 0, 425698.788, 4593703.817, 691.9 },
      { 36,  5,  5, 0, 425697.538, 4593713.197, 701.6 },
      { 37,  5,  5, 0, 425694.328, 4593738.867, 727.5 },
      { 38,  5,  5, 0, 425689.918, 4593777.557, 766.4 },
      { 39, 11, 11, 0, 425689.998, 4593796.487, 785.3 },
      { 40, 11, 11, 0, 425707.608, 4593810.657, 807.9 },
      { 41, 12, 12, 0, 425720.299, 4593836.167, 836.4 },
      { 42, 12, 12, 0, 425714.169, 4593865.877, 866.7 },
      { 43, 13, 13, 0, 425688.349, 4593886.497, 899.7 },
      { 44, 13, 13, 0, 425672.629, 4593908.747, 926.9 },
      { 45,  9,  9, 0, 425668.519, 4593945.147, 963.5 },
      { 46,  9,  9, 0, 425664.350, 4593974.607, 993.3 },
      { 47,  9,  9, 0, 425660.510, 4594004.617, 1023.6 },
      { 48,  9,  9, 0, 425657.550, 4594027.047, 1046.2 },
      { 49,  9,  9, 0, 425654.010, 4594052.557, 1072.0 },
      { 50,  9,  9, 0, 425651.230, 4594075.767, 1095.4 },
      { 51,  9,  9, 0, 425647.531, 4594102.228, 1122.1 },
      { 52,  9,  9, 0, 425644.081, 4594125.998, 1146.1 },
      { 53,  9,  9, 0, 425640.381, 4594153.008, 1173.4 },
      { 54,  9,  9, 0, 425636.721, 4594177.968, 1198.6 },
      { 55, 10, 10, 0, 425635.451, 4594196.128, 1216.8 },
      { 56, 10, 10, 0, 425645.221, 4594209.978, 1233.7 },
      { 57, 10, 10, 0, 425650.062, 4594233.978, 1258.2 },
      { 58, 10, 10, 0, 425635.462, 4594251.408, 1280.9 },
      { 59, 10, 10, 0, 425611.732, 4594252.118, 1304.6 },
      { 60, 10, 10, 0, 425597.461, 4594236.018, 1326.1 },
      { 61, 10, 10, 0, 425597.351, 4594219.698, 1342.4 },
      {  1, 14, 14, 0, 425700.077, 4593573.106, 612.47 },
      {  2, 14, 14, 0, 425704.186, 4593554.056, 631.96 },
      {  3, 14, 14, 0, 425712.456, 4593530.866, 656.58 },
      {  4, 14, 14, 0, 425726.096, 4593507.216, 683.88 },
      {  5, 15, 15, 0, 425742.696, 4593488.276, 709.06 },
      {  6, 15, 15, 0, 425754.896, 4593477.496, 725.34 },
      {  7, 15, 15, 0, 425772.266, 4593462.726, 748.14 },
      {  8, 15, 15, 0, 425787.426, 4593449.865, 768.02 },
      {  9, 15, 15, 0, 425799.846, 4593438.855, 784.62 },
      { 10, 15, 15, 0, 425815.886, 4593425.365, 805.58 },
      { 11, 15, 15, 0, 425832.706, 4593410.995, 827.70 },
      { 12, 15, 15, 0, 425847.406, 4593397.985, 847.33 },
      { 13, 15, 15, 0, 425865.165, 4593383.135, 870.48 },
      { 14, 15, 15, 0, 425876.275, 4593373.965, 884.03 },
      { 15, 16, 16, 0, 425885.925, 4593365.725, 897.58 },
      { 16, 16, 16, 0, 425903.235, 4593350.794, 920.44 },
      { 17, 16, 16, 0, 425917.335, 4593338.344, 939.25 },
      { 18, 16, 16, 0, 425934.355, 4593322.634, 962.41 },
      { 19, 16, 16, 0, 425950.285, 4593308.904, 983.44 },
      { 20, 16, 16, 0, 425964.925, 4593295.814, 1003.08 },
      { 21, 16, 16, 0, 425980.245, 4593282.334, 1023.48 },
      { 22, 16, 16, 0, 425993.945, 4593269.804, 1042.05 },
      { 23, 16, 16, 0, 426009.485, 4593256.473, 1062.52 },
      { 24, 16, 16, 0, 426021.185, 4593245.943, 1078.26 },
      { 25, 16, 16, 0, 426039.995, 4593229.743, 1103.09 },
      { 26, 16, 16, 0, 426053.684, 4593215.953, 1122.52 },
      { 27, 16, 16, 0, 426068.394, 4593198.213, 1145.57 },
      { 28, 16, 16, 0, 426077.144, 4593182.903, 1163.20 },
      { 29, 16, 16, 0, 426084.894, 4593163.733, 1183.88 },
      { 30, 16, 16, 0, 426088.164, 4593149.973, 1198.02 },
      { 31, 16, 16, 0, 426090.574, 4593132.993, 1215.17 },
      { 32, 16, 16, 0, 426090.184, 4593112.173, 1235.99 },
      { 33, 17, 17, 0, 426089.464, 4593090.493, 1257.69 },
      { 34, 17, 17, 0, 426087.913, 4593070.863, 1277.38 },
      { 35, 17, 17, 0, 426087.223, 4593052.573, 1295.68 },
      { 36, 17, 17, 0, 426079.393, 4593036.643, 1313.43 },
      { 37, 17, 17, 0, 426058.333, 4593019.193, 1340.78 },
      { 38, 17, 17, 0, 426055.423, 4592997.293, 1362.87 },
      { 39, 17, 17, 0, 426065.473, 4592978.493, 1384.19 },
      { 40, 17, 17, 0, 426084.143, 4592970.412, 1404.53 },
      { 41, 17, 17, 0, 426100.293, 4592972.932, 1420.88 },
      { 42, 17, 17, 0, 426120.693, 4592997.172, 1452.56 },
      { 43, 17, 17, 0, 426115.293, 4593027.512, 1483.38 },
      { 44, 17, 17, 0, 426101.853, 4593048.402, 1508.22 },
      { 45, 17, 17, 0, 426103.843, 4593073.702, 1533.60 }
     };

     int count = 106;
     Float64 distance;
     PointFS cpol; // closest Point On Line

     if (coord_x == 0.0 && coord_y == 0.0){
      coord_x = 426076.0;
      coord_y = 4593181.0;
     }

     // Test points
     const PointFS
     q0 = { 0, 0, 0, 0, coord_x, coord_y, 0.0 };

     distance = point_to_polylines(rtd, count, q0, &cpol);

     return (long) cpol.pk;
}

